<!DOCTYPE html>
<html>
<head>
  <!-- Importing the Jquery Library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

  <script>
        if (localStorage.getItem("userid") == null ||
            localStorage.getItem("fname") == null ||
            localStorage.getItem("lname") == null)
        {
            window.location.href = "login.html";
        }
  </script>
</head>

<body>

    <h1>Previous Orders</h1>

    <div>
        <button onclick="view()"> Check </button>

        
    </div>

    <div id="menuContainer"></div>

    <script>
        function view() 
        {
            var userID = localStorage.getItem("userid");
            var url = `http://localhost:4001/api/menu_order/${userID}`;

            $.get(url, function (data, status) 
            {
                console.log(data.errors)
                console.log(data)
                var order = data.data
                //alert("Data: " + data + "\nStatus: " + status);

                if (status === "success") 
                {
                    for (let i = 0; i < order.length; i++)
                    {
                        var food = order[i].menuid
                        var url2 = `http://localhost:4001/api/menu/${food}`;

                        $.get(url2, function (data, status)
                        {
                            console.log(data.errors)
                            console.log(data)
                            
                            if (status === "success")
                            {
                                var menuContainer = document.getElementById("menuContainer");
                                menuContainer.innerHTML = ""; // Clear previous content

                                response.data.forEach(function (menu) {
                                    console.log("Menu item:", menu); // Log each menu item to verify its structure

                                    var menuElement = document.createElement("div");
                                    menuElement.innerHTML = `
                                        <p>Menu ID: ${menu.menuid}</p>
                                        <p>Name: ${menu.name}</p>
                                        <p>Description: ${menu.description}</p>
                                        <hr>
                                    `;
                                    menuContainer.appendChild(menuElement);
                                });
                            }
                        })
                    }
                }

            });
        }
        
    </script>
    
</body>
</html>